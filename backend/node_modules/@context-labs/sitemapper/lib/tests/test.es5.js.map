{"version":3,"file":"test.es5.js","names":["require","sitemapper","isUrl","Sitemapper","describe","beforeEach","it","initializeTimeout","should","be","Function","crawl","parse","fetch","url","equal","timeout","done","then","data","sites","Array","length","above","true","catch","error","console","errors","requestHeaders","\"Accept-Encoding\"","greaterThan","getSites","err"],"sources":["../../src/tests/test.es5.js"],"sourcesContent":["require('async');\nrequire('assert');\nrequire('should');\nconst isUrl = require('is-url');\n\nconst Sitemapper = require('../../lib/assets/sitemapper.js');\nvar sitemapper;\n\ndescribe('Sitemapper', function () {\n\n  beforeEach(() => {\n    sitemapper = new Sitemapper();\n  });\n\n  describe('Sitemapper Class', function () {\n\n    it('should have initializeTimeout method', () => {\n      sitemapper.initializeTimeout.should.be.Function;\n    });\n\n    it('should have crawl method', () => {\n      sitemapper.crawl.should.be.Function;\n    });\n\n    it('should have parse method', () => {\n      sitemapper.parse.should.be.Function;\n    });\n\n    it('should have fetch method', () => {\n      sitemapper.fetch.should.be.Function;\n    });\n\n    it('should construct with a url', () => {\n      sitemapper = new Sitemapper({\n        url: 'google.com',\n      });\n      sitemapper.url.should.equal('google.com');\n    });\n\n    it('should construct with a timeout', () => {\n      sitemapper = new Sitemapper({\n        timeout: 1000,\n      });\n      sitemapper.timeout.should.equal(1000);\n    });\n\n    it('should set timeout', () => {\n      sitemapper.timeout = 1000;\n      sitemapper.timeout.should.equal(1000);\n    });\n\n    it('should set url', () => {\n      sitemapper.url = 1000;\n      sitemapper.url.should.equal(1000);\n    });\n  });\n\n  describe('fetch Method resolves sites to array', function () {\n    it('https://wp.seantburke.com/sitemap.xml sitemaps should be an array', function (done) {\n      this.timeout(30000);\n      const url = 'https://wp.seantburke.com/sitemap.xml';\n      sitemapper.fetch(url)\n        .then(data => {\n          data.sites.should.be.Array;\n          data.url.should.equal(url);\n          data.sites.length.should.be.above(2);\n          isUrl(data.sites[0]).should.be.true;\n          done();\n        })\n        .catch(error => {\n          console.error('Test failed');\n          done(error);\n        });\n    });\n\n    it('gibberish.gibberish should fail silently with an empty array', function (done) {\n      this.timeout(30000);\n      const url = 'http://gibberish.gibberish';\n      sitemapper.fetch(url)\n        .then(data => {\n          data.sites.should.be.Array;\n          data.errors.should.be.Array;\n          done();\n        })\n        .catch(error => {\n          console.error('Test failed');\n          done(error);\n        });\n    });\n\n    it('https://www.google.com/work/sitemap.xml sitemaps should be an array', function (done) {\n      this.timeout(30000);\n      const url = 'https://www.google.com/work/sitemap.xml';\n      sitemapper.fetch(url)\n        .then(data => {\n          data.sites.should.be.Array;\n          data.url.should.equal(url);\n          data.sites.length.should.be.above(2);\n          isUrl(data.sites[0]).should.be.true;\n          done();\n        })\n        .catch(error => {\n          console.error('Test failed');\n          done(error);\n        });\n    });\n\n    it('https://www.golinks.io/sitemap.xml sitemaps should be an array', function (done) {\n      this.timeout(30000);\n      const url = 'https://www.golinks.io/sitemap.xml';\n      sitemapper.timeout = 5000;\n      sitemapper.fetch(url)\n        .then(data => {\n          data.sites.should.be.Array;\n          data.url.should.equal(url);\n          data.sites.length.should.be.above(2);\n          isUrl(data.sites[0]).should.be.true;\n          done();\n        })\n        .catch(error => {\n          console.error('Test failed');\n          done(error);\n        });\n    });\n\n    it('https://www.golinks.io/sitemap.xml sitemaps should return an empty array when timing out', function (done) {\n      this.timeout(30000);\n      const url = 'https://www.golinks.io/sitemap.xml';\n      sitemapper.timeout = 1;\n      sitemapper.fetch(url)\n        .then(data => {\n          data.sites.should.be.Array;\n          done();\n        })\n        .catch(error => {\n          console.error('Test failed');\n          done(error);\n        });\n    });\n  });\n\n  describe('gzipped sitemaps', function () {\n    beforeEach(() => {\n      sitemapper = new Sitemapper({\n        requestHeaders: {\n          'Accept-Encoding': 'gzip,deflate,sdch',\n        }\n      });\n    });\n\n    it('https://www.banggood.com/sitemap/category.xml.gz gzip should be a non-empty array', function (done) {\n      this.timeout(30000);\n      const url = 'https://www.banggood.com/sitemap/category.xml.gz';\n      sitemapper.timeout = 10000;\n      sitemapper.fetch(url)\n        .then(data => {\n          data.sites.should.be.Array;\n          data.errors.should.be.Array;\n          data.sites.length.should.be.greaterThan(0);\n          done();\n        })\n        .catch(error => {\n          console.error('Test failed');\n          done(error);\n        });\n    });\n  });\n\n  describe('getSites method', function () {\n    it('getSites should be backwards compatible', function (done) {\n      this.timeout(30000);\n      const url = 'https://wp.seantburke.com/sitemap.xml';\n      sitemapper.getSites(url, (err, sites) => {\n        sites.should.be.Array;\n        isUrl(sites[0]).should.be.true;\n        done();\n      });\n    });\n  });\n});\n"],"mappings":"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"}